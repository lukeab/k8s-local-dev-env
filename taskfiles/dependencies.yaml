# https://taskfile.dev

version: '3'

tasks:
  check_availablecommands_dependencies:
    desc: Test the availability of commands in the environment.
    vars:
      COMMAND_DEPENDENCIES: docker k3d kubectl helm openssl certutil envsubst
    cmds:
      - |
        echo "Testing dependencies" 
        ALL_AVAILABLE="X1"
        for i in {{.COMMAND_DEPENDENCIES}} ; do command -v $i &> /dev/null || ALL_AVAILABLE="X0"; done
        if [ "$ALL_AVAILABLE" == "X0" ]; then
          for i in {{.COMMAND_DEPENDENCIES}} ; do 
            if command -v $i &> /dev/null; then
              echo -n -e '\u2705' "${i} "
            else
              echo -n -e '\u274c' "${i} "
            fi
          done;
          echo; echo -e "â›” Dependencies missing, install any missing commands from above before continuing"
        else
          echo -e "\u2705 All dependnecies available"
        fi
    silent: true
    internal: true